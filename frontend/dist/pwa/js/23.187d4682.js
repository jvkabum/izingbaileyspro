(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[23],{d84c:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return"admin"===e.userProfile?t("div",[t("div",{staticClass:"row col q-pa-md justify-between items-center"},[t("h1",[e._v(" Painel Atendimentos ")]),t("q-btn",{attrs:{color:"primary",icon:"mdi-filter",label:"Filtros"},on:{click:function(t){e.visualizarFiltros=!0}}}),t("q-separator")],1),t("q-dialog",{attrs:{"full-height":"",position:"right"},model:{value:e.visualizarFiltros,callback:function(t){e.visualizarFiltros=t},expression:"visualizarFiltros"}},[t("q-card",{staticStyle:{width:"300px"}},[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("Filtros")])]),t("q-card-section",{staticClass:"q-gutter-md"},[t("DatePick",{staticClass:"row col",attrs:{dense:""},model:{value:e.pesquisaTickets.dateStart,callback:function(t){e.$set(e.pesquisaTickets,"dateStart",t)},expression:"pesquisaTickets.dateStart"}}),t("DatePick",{staticClass:"row col",attrs:{dense:""},model:{value:e.pesquisaTickets.dateEnd,callback:function(t){e.$set(e.pesquisaTickets,"dateEnd",t)},expression:"pesquisaTickets.dateEnd"}}),"admin"===e.profile?t("q-separator"):e._e(),"admin"===e.profile?t("q-toggle",{staticClass:"q-ml-lg",attrs:{label:"(Admin) - Visualizar Todos"},model:{value:e.pesquisaTickets.showAll,callback:function(t){e.$set(e.pesquisaTickets,"showAll",t)},expression:"pesquisaTickets.showAll"}}):e._e(),"admin"===e.profile?t("q-separator",{staticClass:"q-mb-md"}):e._e(),e.pesquisaTickets.showAll?e._e():t("q-select",{attrs:{square:"",dense:"",outlined:"","hide-bottom-space":"","emit-value":"","map-options":"",multiple:"","options-dense":"","use-chips":"",label:"Filas",color:"primary",options:e.filas,"input-debounce":700,"option-value":"id","option-label":"queue","input-style":"width: 280px; max-width: 280px;"},model:{value:e.pesquisaTickets.queuesIds,callback:function(t){e.$set(e.pesquisaTickets,"queuesIds",t)},expression:"pesquisaTickets.queuesIds"}})],1),t("q-card-section",[t("q-separator"),t("div",{staticClass:"text-h6 q-mt-md"},[e._v("Tipo de visualização")]),t("q-option-group",{attrs:{options:e.optionsVisao,label:"Visão",type:"radio"},model:{value:e.visao,callback:function(t){e.visao=t},expression:"visao"}})],1),t("q-card-actions",{attrs:{align:"center"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{outline:"",label:"Atualizar",color:"primary"},on:{click:e.consultarTickets}})],1)],1)],1),t("div",{staticClass:"scroll",staticStyle:{height:"85vh"}},[e._l(e.sets,(function(s,i){return[t("div",{key:i,staticClass:"row q-pa-md q-col-gutter-md q-mb-sm",style:{height:800}},[e._l(s,(function(s,i){return t("div",{key:i,class:e.contentClass},[t("q-card",{attrs:{bordered:"",square:"",flat:""}},["U"===e.visao||"US"===e.visao?t("q-item",{staticClass:"text-bold",class:{"bg-negative text-white":"Pendente"===e.definirNomeUsuario(s[0])}},[t("q-item-section",[t("q-item-label",{staticClass:"text-bold text-h6"},[e._v(e._s(e.definirNomeUsuario(s[0])))]),t("q-item-label",{class:{"text-white":"Pendente"===e.definirNomeUsuario(s[0])},attrs:{caption:""}},[e._v("\n                  Atendimentos: "+e._s(s.length)+"\n                ")])],1)],1):e._e(),"F"===e.visao||"FS"===e.visao?t("q-item",{staticClass:"text-bold",class:{"bg-negative text-white":"Sem Fila"===e.definirNomeFila(s[0])}},[t("q-item-section",{attrs:{avatar:""}},[t("q-avatar",[t("img",{attrs:{src:"https://cdn.quasar.dev/img/boy-avatar.png"}})])],1),t("q-item-section",[t("q-item-label",[e._v(e._s(e.definirNomeFila(s[0])))]),t("q-item-label",{class:{"text-white":"Sem Fila"===e.definirNomeFila(s[0])},attrs:{caption:""}},[e._v("\n                  Abertos: "+e._s(e.counterStatus(s).open)+" | Pendentes: "+e._s(e.counterStatus(s).pending)+" | Total: "+e._s(s.length)+"\n                ")])],1)],1):e._e(),t("q-separator"),"U"===e.visao||"F"===e.visao?t("q-card-section",{staticClass:"scroll",style:{height:"320px"}},e._l(s,(function(s,i){return t("ItemTicket",{key:i,attrs:{ticket:s,filas:e.filas}})})),1):e._e()],1)],1)})),t("q-resize-observer",{on:{resize:e.onResize}})],2)]}))],2)],1):e._e()},a=[],o=(s("14d9"),s("29b2")),l=s("0ffe"),n=s("ab52"),r=s("ee0e"),c=s("2ef0"),u=s("b166"),d=s("ef06");const p=JSON.parse(localStorage.getItem("usuario")),h=Object(o["a"])(),m=localStorage.getItem("queues"),v=localStorage.getItem("profile");var f={name:"Painel De Controle",components:{ItemTicket:l["a"]},data(){return{userProfile:"user",profile:v,visualizarFiltros:!1,slide:0,height:400,optionsVisao:[{label:"Por Usuário",value:"U"},{label:"Por Usuário (Sintético)",value:"US"},{label:"Por Filas",value:"F"},{label:"Por Filas (Sintético)",value:"FS"}],visao:"U",pesquisaTickets:{showAll:!0,dateStart:Object(u["a"])(Object(d["a"])(new Date,{days:30}),"yyyy-MM-dd"),dateEnd:Object(u["a"])(new Date,"yyyy-MM-dd"),queuesIds:[]},tickets:[],filas:[],sizes:{lg:3,md:3,sm:2,xs:1}}},computed:{contentClass(){let e="col";const t=Object.keys(this.cTicketsUser[0]).length;for(const s of["xl","lg","md","sm","xs"])if(this.sizes[s]){const i=this.sizes[s]>t?t:this.sizes[s];e+=" col-"+s+"-"+12/i}return e},sets(){const e=[],t=Math.ceil(this.cTicketsUser.length/this.itemsPerSet);for(let s=0;s<t;s++){const t=s*this.itemsPerSet,i=t+this.itemsPerSet;e.push(this.cTicketsUser.slice(t,i))}return e[0]},itemsPerSet(){let e=!1;for(const t of["xl","lg","md","sm","xs"])if(e=e||this.$q.screen[t],e&&this.sizes[t])return this.sizes[t];return 1},cUserQueues(){try{const e=JSON.parse(m).map((e=>{if(e.isActive)return e.id}));return this.filas.filter((t=>e.includes(t.id)))||[]}catch(e){return[]}},cTicketsUser(){const e="U"===this.visao||"US"===this.visao?"userId":"queueId";return[Object(c["groupBy"])(this.tickets,e)]}},methods:{deleteTicket(e){const t=[...this.tickets],s=t.filter((t=>t.id!==e));this.tickets=[...s]},updateTicket(e){const t=[...this.tickets],s=t.findIndex((t=>e.id));s&&(t[s]=e,this.tickets=[...t])},createTicket(e){const t=[...this.tickets];t.unshift(e),this.tickets=[...t]},verifyIsActionSocket(e){if(!e.id)return!1;if(this.pesquisaTickets.showAll)return!0;if(!this.filas.length)return!0;const t=this.pesquisaTickets.queuesIds.indexOf((t=>e.queueId===t));let s=!1;return-1!==t&&(s=!0),s},conectSocketQueues(e,t){},socketTickets(e){},connectSocket(){this.socketTickets(),this.cUserQueues.forEach((e=>{this.conectSocketQueues(p.tenantId,e.id)}))},definirNomeUsuario(e){var t;return this.verifyIsActionSocket(e),(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.name)||"Pendente"},definirNomeFila(e){const t=this.filas.find((t=>t.id===e.queueId));return(null===t||void 0===t?void 0:t.queue)||"Sem Fila"},counterStatus(e){var t,s,i;const a={open:0,pending:0,closed:0},o=Object(c["groupBy"])(e,"status");return a.open=(null===(t=o.open)||void 0===t?void 0:t.length)||0,a.pending=(null===(s=o.pending)||void 0===s?void 0:s.length)||0,a.closed=(null===(i=o.closed)||void 0===i?void 0:i.length)||0,a},consultarTickets(){Object(n["a"])(this.pesquisaTickets).then((e=>{this.tickets=e.data,this.connectSocket()})).catch((e=>{console.error(e),this.$notificarErro("Erro ao consultar atendimentos",e)}))},onResize({height:e}){this.height=e}},async mounted(){this.userProfile=localStorage.getItem("profile"),await Object(r["d"])().then((e=>{this.filas=e.data})),await this.consultarTickets()},destroyed(){h.disconnect()}},q=f,k=s("2877"),b=s("9c40"),g=s("eb85"),S=s("24e8"),T=s("f09f"),y=s("a370"),w=s("9564"),x=s("ddd8"),_=s("9f0a"),F=s("4b7e"),I=s("66e5"),C=s("4074"),P=s("cb32"),U=s("0170"),z=s("3980"),Q=s("7f67"),A=s("eebe"),O=s.n(A),j=Object(k["a"])(q,i,a,!1,null,"f22082c4",null);t["default"]=j.exports;O()(j,"components",{QBtn:b["a"],QSeparator:g["a"],QDialog:S["a"],QCard:T["a"],QCardSection:y["a"],QToggle:w["a"],QSelect:x["a"],QOptionGroup:_["a"],QCardActions:F["a"],QItem:I["a"],QItemSection:C["a"],QAvatar:P["a"],QItemLabel:U["a"],QResizeObserver:z["a"]}),O()(j,"directives",{ClosePopup:Q["a"]})}}]);