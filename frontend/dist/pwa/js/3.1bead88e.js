(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{3153:function(t,e,a){"use strict";a("e088")},"713b":function(t,e,a){"use strict";a.r(e);a("14d9");var i=function(){var t=this,e=t._self._c;return e("q-layout",{attrs:{view:"hHh Lpr lFf"}},[e("q-header",{staticClass:"bg-white text-grey-8 q-py-xs",attrs:{"height-hint":"58",bordered:""}},[e("q-toolbar",[e("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Menu",icon:"menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}},[e("q-tooltip",[t._v("Menu")])],1),t.$q.screen.gt.xs?e("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"","no-caps":"","no-wrap":"",dense:""}},[e("q-img",{staticStyle:{height:"50px",width:"140px"},attrs:{src:"/logo.png","spinner-color":"primary"}})],1):t._e(),e("q-space"),e("div",{staticClass:"q-gutter-sm row items-center no-wrap"},["admin"===t.userProfile||"user"===t.userProfile?e("div",[e("q-btn",{attrs:{round:"",dense:"",flat:"",color:"grey-8",icon:"notifications"}},[parseInt(t.notifications.count)+parseInt(t.notifications_p.count)>0?e("q-badge",{attrs:{color:"red","text-color":"white",floating:""}},[t._v("\n            "+t._s(parseInt(t.notifications.count)+parseInt(t.notifications_p.count))+"\n          ")]):t._e(),e("q-menu",[e("q-list",{staticStyle:{"min-width":"300px"}},[parseInt(t.notifications.count)+parseInt(t.notifications_p.count)==0?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"}},[t._v("\n                  Nada de novo por aqui!\n                ")])],1):t._e(),parseInt(t.notifications_p.count)>0?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"},attrs:{avatar:""},on:{click:()=>t.$router.push({name:"atendimento"})}},[e("q-avatar",{staticStyle:{width:"60px",height:"60px"},attrs:{color:"blue","text-color":"white"}},[t._v("\n                    "+t._s(t.notifications_p.count)+"\n                  ")])],1),e("q-item-section",{staticStyle:{cursor:"pointer"},on:{click:()=>t.$router.push({name:"atendimento"})}},[t._v("\n                  Clientes pendentes na fila\n                ")])],1):t._e(),t._l(t.notifications.tickets,(function(a){return e("q-item",{key:a.id,staticStyle:{"border-bottom":"1px solid #ddd",margin:"5px"}},[e("q-item-section",{staticStyle:{cursor:"pointer"},attrs:{avatar:""},on:{click:function(e){return t.abrirAtendimentoExistente(a.name,a)}}},[e("q-avatar",{staticStyle:{width:"60px",height:"60px"}},[e("img",{attrs:{src:a.profilePicUrl}})])],1),e("q-item-section",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.abrirAtendimentoExistente(a.name,a)}}},[e("q-list",[e("q-item",{staticStyle:{"text-align":"center","font-size":"17px","font-weight":"bold","min-height":"0"}},[t._v(t._s(a.name))]),e("q-item",{staticStyle:{"min-height":"0","padding-top":"0"}},[e("b",[t._v("Mensagem: ")]),t._v(" "+t._s(a.lastMessage))])],1)],1)],1)}))],2)],1),e("q-tooltip",[t._v("Notificações")])],1),e("q-avatar",{staticClass:"q-ml-lg",attrs:{color:"offline"===t.usuario.status?"negative":"positive","text-color":"white",size:"25px",icon:"offline"===t.usuario.status?"mdi-account-off":"mdi-account-check",rounded:""}},[e("q-tooltip",[t._v("\n            "+t._s("offline"===t.usuario.status?"Usuário Offiline":"Usuário Online")+"\n          ")])],1)],1):t._e(),e("q-btn",{staticClass:"bg-padrao text-bold q-mx-sm q-ml-lg",attrs:{round:"",flat:""}},[e("q-avatar",{attrs:{size:"26px"}},[t._v("\n            "+t._s(t.$iniciaisString(t.username))+"\n          ")]),e("q-menu",[e("q-list",{staticStyle:{"min-width":"100px"}},[e("q-item-label",{attrs:{header:""}},[t._v(" Olá! "),e("b",[t._v(" "+t._s(t.username)+" ")])]),e("cStatusUsuario",{attrs:{usuario:t.usuario},on:{"update:usuario":t.atualizarUsuario}}),e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.abrirModalUsuario}},[e("q-item-section",[t._v("Perfil")])],1),e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.efetuarLogout}},[e("q-item-section",[t._v("Sair")])],1),e("q-separator"),e("q-item",[e("q-item-section",[e("cSystemVersion")],1)],1)],1)],1),e("q-tooltip",[t._v("Usuário")])],1)],1)],1)],1),e("q-drawer",{attrs:{"show-if-above":"",bordered:"",mini:t.miniState,"mini-to-overlay":"","content-class":"bg-white text-grey-9"},on:{mouseover:function(e){t.miniState=!1},mouseout:function(e){t.miniState=!0}},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[e("q-scroll-area",{staticClass:"fit"},[e("q-list",{key:t.userProfile,attrs:{padding:""}},["admin"===t.userProfile||"user"===t.userProfile?e("div",t._l(t.menuData,(function(a){return e("EssentialLink",t._b({key:a.title},"EssentialLink",a,!1))})),1):t._e(),"admin"===t.userProfile?e("div",[e("q-separator",{attrs:{spaced:""}}),e("div",{staticClass:"q-mb-lg"}),t._l(t.menuDataAdmin,(function(a){return[t.exibirMenuBeta(a)?e("EssentialLink",t._b({key:a.title},"EssentialLink",a,!1)):t._e()]}))],2):t._e(),"super"===t.userProfile?e("div",[e("div",{staticClass:"q-mb-lg"}),t._l(t.menuDataSuper,(function(a){return[t.exibirMenuBeta(a)?e("EssentialLink",t._b({key:a.title},"EssentialLink",a,!1)):t._e()]}))],2):t._e()])],1),e("div",{staticClass:"absolute-bottom text-center row justify-start",class:{"bg-grey-3":t.$q.dark.isActive},staticStyle:{height:"40px"}},[e("q-toggle",{staticClass:"text-bold q-ml-xs",attrs:{size:"xl","keep-color":"",dense:"","icon-color":t.$q.dark.isActive?"black":"white",value:t.$q.dark.isActive,color:t.$q.dark.isActive?"grey-3":"black","checked-icon":"mdi-white-balance-sunny","unchecked-icon":"mdi-weather-sunny"},on:{input:function(e){return t.$setConfigsUsuario({isDark:!t.$q.dark.isActive})}}},[e("q-tooltip",{attrs:{"content-class":"text-body1 hide-scrollbar"}},[t._v("\n          "+t._s(t.$q.dark.isActive?"Desativar":"Ativar")+" Modo Escuro (Dark Mode)\n        ")])],1)],1)],1),e("q-page-container",[e("q-page",{staticClass:"q-pa-xs"},[e("router-view")],1)],1),"admin"===t.userProfile||"user"===t.userProfile?e("audio",{ref:"audioNotification"},[e("source",{attrs:{src:t.alertSound,type:"audio/mp3"}})]):t._e(),e("ModalUsuario",{attrs:{isProfile:!0,modalUsuario:t.modalUsuario,usuarioEdicao:t.usuario},on:{"update:modalUsuario":function(e){t.modalUsuario=e},"update:modal-usuario":function(e){t.modalUsuario=e},"update:usuarioEdicao":function(e){t.usuario=e},"update:usuario-edicao":function(e){t.usuario=e}}})],1)},o=[],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-caption text-center bg-grey-1 q-pa-sm"},[t._v("\n  Versão Sistema:\n  "),e("q-badge",{attrs:{align:"middle",color:"primary"}},[e("a",{attrs:{target:"_blank",href:t.github}},[t._v(" v"+t._s(t.cVersion)+" ")])])],1)},n=[],r=a("9224"),c={name:"SystemVersion",computed:{cVersion(){return r.version},github(){return r.github}}},u=c,l=a("2877"),d=a("58a8"),m=a("eebe"),p=a.n(m),f=Object(l["a"])(u,s,n,!1,null,null,null),h=f.exports;p()(f,"components",{QBadge:d["a"]});var g=a("5c26"),v=function(){var t=this,e=t._self._c;return e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"houverList",class:{"text-negative text-bolder":"negative"===t.color},attrs:{clickable:"",active:t.routeName==t.cRouterName,"active-class":"bg-blue-1 text-grey-8 text-bold menu-link-active-item-top"},on:{click:()=>t.routeName!=t.cRouterName?t.$router.push({name:t.routeName}):""}},[t.icon?e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:"negative"===t.color?"mdi-cellphone-nfc-off":t.icon}})],1):t._e(),e("q-item-section",[e("q-item-label",[t._v(t._s(t.title))]),e("q-item-label",{attrs:{caption:""}})],1)],1)},b=[],q={name:"EssentialLink",data(){return{menuAtivo:"dashboard"}},props:{title:{type:String,required:!0},caption:{type:String,default:""},color:{type:String,default:""},routeName:{type:String,default:"dashboard"},icon:{type:String,default:""}},computed:{cRouterName(){return this.$route.name}}},w=q,S=(a("3153"),a("66e5")),k=a("4074"),x=a("0016"),y=a("0170"),_=a("714f"),N=Object(l["a"])(w,v,b,!1,null,null,null),C=N.exports;p()(N,"components",{QItem:S["a"],QItemSection:k["a"],QIcon:x["a"],QItemLabel:y["a"]}),p()(N,"directives",{Ripple:_["a"]});var I=a("5d20"),O=a("86e2"),A=a.n(O),P=a("b166"),$=a("25c4"),D=a("2f62"),E=a("7963"),U=a("7884"),Q=function(){var t=this,e=t._self._c;return e("div",[e("q-select",{attrs:{borderless:"",dense:"",rounded:"",options:t.statusOptions,"map-options":"","emit-value":""},on:{input:t.updateStatus},scopedSlots:t._u([{key:"selected",fn:function(){return[e("div",{staticClass:"row full-width justify-center"},[e("q-chip",{staticClass:"q-my-none q-ml-sm q-mr-none q-py-md",attrs:{color:"grey-3","text-color":"primary"}},[e("q-avatar",{attrs:{color:t.cStatus.color,"text-color":"white",size:"40px",icon:t.cStatus.icon,rounded:""}}),t._v("\n          "+t._s(t.cStatus.label)+"\n        ")],1)],1)]},proxy:!0}]),model:{value:t.usuario.status,callback:function(e){t.$set(t.usuario,"status",e)},expression:"usuario.status"}})],1)},M=[],T={name:"cUserStatus",props:{usuario:{type:Object,default:()=>{}}},computed:{cStatus(){const t=this.usuario;return this.statusOptions.find((e=>e.value==t.status))||{}}},data(){return{status:{},statusOptions:[{label:"Online",value:"online",icon:"mdi-account-check",color:"positive"},{label:"Offline",value:"offline",icon:"mdi-account-off",color:"negative"}]}},methods:{updateStatus(t){const e={...this.usuario,status:t};localStorage.setItem("usuario",JSON.stringify(e)),this.$emit("update:usuario",e),console.log("usuario",e)}}},j=T,L=a("ddd8"),F=a("b047"),R=a("cb32"),z=Object(l["a"])(j,Q,M,!1,null,null,null),B=z.exports;p()(z,"components",{QSelect:L["a"],QChip:F["a"],QAvatar:R["a"]});var H=a("29b2"),J=a("c5bd");const V=localStorage.getItem("username"),G=Object(H["a"])(),W=[{title:"Painel de Controle",caption:"",icon:"mdi-home",routeName:"home-dashboard"},{title:"Chat",caption:"Lista de atendimentos",icon:"mdi-whatsapp",routeName:"atendimento"},{title:"Contatos",caption:"Lista de contatos",icon:"mdi-contacts-outline",routeName:"contatos"}],Y=[{title:"Conexões",caption:"Canais de Comunicação",icon:"mdi-cellphone-wireless",routeName:"sessoes"},{title:"Painel Atendimentos",caption:"Visão geral dos atendimentos",icon:"mdi-view-dashboard-variant",routeName:"painel-atendimentos"},{title:"Relatórios",caption:"Relatórios gerais",icon:"mdi-file-chart",routeName:"relatorios"},{title:"Usuários ",caption:"Admin de usuários",icon:"mdi-account-group",routeName:"usuarios"},{title:"Filas",caption:"Cadastro de Filas",icon:"mdi-arrow-decision-outline",routeName:"filas"},{title:"Mensagens Rápidas",caption:"Mensagens pré-definidas",icon:"mdi-reply-all-outline",routeName:"mensagens-rapidas"},{title:"Chatbot",caption:"Robô de atendimento",icon:"mdi-robot",routeName:"chat-flow"},{title:"Etiquetas",caption:"Cadastro de etiquetas",icon:"mdi-tag-text",routeName:"etiquetas"},{title:"Horário de Atendimento",caption:"Horário de funcionamento",icon:"mdi-calendar-clock",routeName:"horarioAtendimento"},{title:"Configurações",caption:"Configurações gerais",icon:"mdi-cog",routeName:"configuracoes"},{title:"Campanha",caption:"Campanhas de envio",icon:"mdi-message-bookmark-outline",routeName:"campanhas"},{title:"API",caption:"Integração sistemas externos",icon:"mdi-call-split",routeName:"api-service"}],K=[{title:"Empresas",caption:"Admin das Empresas",icon:"mdi-office-building",routeName:"empresassuper"},{title:"Usuários",caption:"Admin de usuários",icon:"mdi-account-group",routeName:"usuariossuper"},{title:"Conexões",caption:"Canais de Comunicação",icon:"mdi-cellphone-wireless",routeName:"sessaosuper"}];var X={name:"MainLayout",mixins:[I["a"]],components:{EssentialLink:C,ModalUsuario:$["a"],cStatusUsuario:B,cSystemVersion:h},data(){return{username:V,domainExperimentalsMenus:["@"],miniState:!0,userProfile:"user",modalUsuario:!1,usuario:{},alertSound:A.a,leftDrawerOpen:!1,menuData:W,menuDataAdmin:Y,menuDataSuper:K,countTickets:0,ticketsList:[]}},computed:{...Object(D["b"])(["notifications","notifications_p","whatsapps"]),cProblemaConexao(){const t=this.whatsapps.findIndex((t=>["PAIRING","TIMEOUT","DISCONNECTED"].includes(t.status)));return-1!==t},cQrCode(){const t=this.whatsapps.findIndex((t=>"qrcode"===t.status||"DESTROYED"===t.status));return-1!==t},cOpening(){const t=this.whatsapps.findIndex((t=>"OPENING"===t.status));return-1!==t},cUsersApp(){return this.$store.state.usersApp},cObjMenu(){return this.cProblemaConexao?W.map((t=>("sessoes"===t.routeName&&(t.color="negative"),t))):W}},methods:{exibirMenuBeta(t){if(null===t||void 0===t||!t.isBeta)return!0;for(const e of this.domainExperimentalsMenus)if(-1!==this.usuario.email.indexOf(e))return!0;return!1},async listarWhatsapps(){const{data:t}=await Object(g["d"])();this.$store.commit("LOAD_WHATSAPPS",t)},handlerNotifications(t){const{message:e,contact:a,ticket:i}=t,o={body:`${e.body} - ${Object(P["a"])(new Date,"HH:mm")}`,icon:a.profilePicUrl,tag:i.id,renotify:!0},s=new Notification(`Mensagem de ${a.name}`,o);s.onclick=t=>{t.preventDefault(),window.focus(),this.$store.dispatch("AbrirChatMensagens",i),this.$router.push({name:"atendimento"})},this.$nextTick((()=>{this.$refs.audioNotification.play()}))},async abrirModalUsuario(){this.modalUsuario=!0},async efetuarLogout(){try{await Object(U["b"])(this.usuario),localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("profile"),localStorage.removeItem("userId"),localStorage.removeItem("queues"),localStorage.removeItem("usuario"),localStorage.removeItem("filtrosAtendimento"),this.$router.go({name:"login",replace:!0})}catch(t){this.$notificarErro("Não foi possível realizar logout",t)}},async listarConfiguracoes(){const{data:t}=await Object(E["b"])();localStorage.setItem("configuracoes",JSON.stringify(t))},conectarSocket(t){G.on(`${t.tenantId}:chat:updateOnlineBubbles`,(t=>{this.$store.commit("SET_USERS_APP",t)}))},atualizarUsuario(){this.usuario=JSON.parse(localStorage.getItem("usuario")),"offline"===this.usuario.status&&G.emit(`${this.usuario.tenantId}:setUserIdle`),"online"===this.usuario.status&&G.emit(`${this.usuario.tenantId}:setUserActive`)},async consultarTickets(){const t={searchParam:"",pageNumber:1,status:["open"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!0,isNotAssignedUser:!1,includeNotQueueDefined:!0};try{const{data:e}=await Object(J["e"])(t);this.countTickets=e.count,this.$store.commit("UPDATE_NOTIFICATIONS",e)}catch(a){this.$notificarErro("Algum problema",a),console.error(a)}const e={searchParam:"",pageNumber:1,status:["pending"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!1,isNotAssignedUser:!1,includeNotQueueDefined:!0};try{const{data:t}=await Object(J["e"])(e);this.countTickets=t.count,this.$store.commit("UPDATE_NOTIFICATIONS_P",t)}catch(a){this.$notificarErro("Algum problema",a),console.error(a)}},abrirChatContato(t){this.$q.screen.lt.md&&"pending"!==t.status&&this.$root.$emit("infor-cabecalo-chat:acao-menu"),"pending"===t.status||t.id===this.$store.getters.ticketFocado.id&&"chat"===this.$route.name||(this.$store.commit("SET_HAS_MORE",!0),this.$store.dispatch("AbrirChatMensagens",t))},abrirAtendimentoExistente(t,e){this.$q.dialog({title:"Atenção!!",message:`${t} possui um atendimento em curso (Atendimento: ${e.id}). Deseja abrir o atendimento?`,cancel:{label:"Não",color:"primary",push:!0},ok:{label:"Sim",color:"negative",push:!0},persistent:!0}).onOk((async()=>{try{this.abrirChatContato(e)}catch(t){this.$notificarErro("Não foi possível atualizar o token",t)}}))}},async mounted(){this.atualizarUsuario(),await this.listarWhatsapps(),await this.listarConfiguracoes(),await this.consultarTickets(),"Notification"in window&&Notification.requestPermission(),this.usuario=JSON.parse(localStorage.getItem("usuario")),this.userProfile=localStorage.getItem("profile"),await this.conectarSocket(this.usuario)},destroyed(){G.disconnect()}},Z=X,tt=(a("fb67"),a("4d5a")),et=a("e359"),at=a("65c6"),it=a("9c40"),ot=a("05c0"),st=a("068f"),nt=a("2c91"),rt=a("4e73"),ct=a("1c1c"),ut=a("eb85"),lt=a("9404"),dt=a("4983"),mt=a("9564"),pt=a("09e3"),ft=a("9989"),ht=a("7f67"),gt=Object(l["a"])(Z,i,o,!1,null,"35a03cbf",null);e["default"]=gt.exports;p()(gt,"components",{QLayout:tt["a"],QHeader:et["a"],QToolbar:at["a"],QBtn:it["a"],QTooltip:ot["a"],QImg:st["a"],QSpace:nt["a"],QBadge:d["a"],QMenu:rt["a"],QList:ct["a"],QItem:S["a"],QItemSection:k["a"],QAvatar:R["a"],QItemLabel:y["a"],QSeparator:ut["a"],QDrawer:lt["a"],QScrollArea:dt["a"],QToggle:mt["a"],QPageContainer:pt["a"],QPage:ft["a"]}),p()(gt,"directives",{ClosePopup:ht["a"]})},9224:function(t){t.exports=JSON.parse('{"name":"FlowDeskPro","version":"2.6.0","description":"Bot Multiatendimento, multicanais e multiempresas.","productName":"FlowDeskPro","author":"FlowDeskPro <FlowDeskPro@FlowDeskPro.io>","private":false,"license":"AGPL-3.0-or-later","github":"https://github.com/flowdeskpro/flowdeskpro.git","scripts":{"start":"pm2 start server.js --name FlowDeskPro-frontend","stop":"pm2 stop server.js --name FlowDeskPro-frontend","build":"export NODE_OPTIONS=--openssl-legacy-provider && npx quasar build -P -m pwa"},"dependencies":{"@quasar/cli":"^2.4.0","@quasar/extras":"^1.16.3","apexcharts":"^3.40.0","axios":"^1.4.0","caniuse-lite":"^1.0.30001653","core-js":"^3.30.2","date-fns":"^2.30.0","dotenv":"^16.0.3","drawflow":"0.0.59","js-base64":"^3.7.5","lodash":"^4.17.21","mic-recorder-to-mp3":"^2.2.2","printd":"^1.6.0","qrcode.vue":"^1.7.0","quasar":"^1.22.10","socket.io-client":"^3.1.3","v-emoji-picker":"^2.3.3","vdata-parser":"^0.1.5","vue":"^2.7.14","vue-apexcharts":"^1.6.2","vue-codemirror":"^4.0.6","vue-easy-lightbox":"^0.14.0","vue-facebook-login-component":"^4.0.2","vue-infinite-loading":"^2.4.5","vue-linkify":"^1.0.1","vue-loader":"^15.10.1","vuedraggable":"^2.24.3","vuelidate":"^0.7.7","vuelidate-error-extractor":"^2.4.1","xlsx":"^0.16.9"},"devDependencies":{"@babel/plugin-proposal-optional-chaining":"^7.21.0","@quasar/app":"^2.4.3","babel-eslint":"^10.1.0","eslint":"^6.8.0","eslint-config-standard":"^14.1.0","eslint-loader":"^3.0.3","eslint-plugin-import":"^2.14.0","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.0.1","eslint-plugin-standard":"^4.0.0","eslint-plugin-vue":"^6.1.2","quasar-app-extension-qdatetimepicker":"^1.0.0-rc.18","workbox-webpack-plugin":"^6.6.0"},"browserslist":["last 10 Chrome versions","last 10 Firefox versions","last 4 Edge versions","last 7 Safari versions","last 8 Android versions","last 8 ChromeAndroid versions","last 8 FirefoxAndroid versions","last 10 iOS versions","last 5 Opera versions"],"engines":{"node":">= 18.20.3","npm":">= 6.13.4","yarn":">= 1.21.1"}}')},"9eef":function(t,e,a){},e088:function(t,e,a){},fb67:function(t,e,a){"use strict";a("9eef")}}]);