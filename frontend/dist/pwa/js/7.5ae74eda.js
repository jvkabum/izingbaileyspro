(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"0513":function(t,e,a){"use strict";a("3dd4")},"1b44":function(t,e,a){"use strict";a("4393")},"3dd4":function(t,e,a){},4393:function(t,e,a){},"989e":function(t,e,a){"use strict";a.r(e);a("14d9");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"WAL position-relative bg-grey-3",style:t.style},[e("q-layout",{staticClass:"WAL__layout shadow-3",attrs:{container:"",view:"lHr LpR lFr"}},[e("q-drawer",{attrs:{"show-if-above":"",overlay:t.$q.screen.lt.md,persistent:"",breakpoint:769,bordered:"",width:t.$q.screen.lt.md?t.$q.screen.width:380,"content-class":"hide-scrollbar full-width"},on:{hide:function(e){t.drawerTickets=!1}},model:{value:t.drawerTickets,callback:function(e){t.drawerTickets=e},expression:"drawerTickets"}},[e("q-toolbar",{staticClass:"q-gutter-xs full-width",staticStyle:{height:"64px"}},[e("q-btn-dropdown",{staticClass:"text-bold btn-rounded",attrs:{"no-caps":"",color:"black",ripple:""},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",{staticClass:"ellipsis",style:{maxWidth:t.$q.screen.lt.sm?"120px":""}},[t._v("\n              "+t._s(t.username)+"\n            ")])]},proxy:!0}])},[e("q-list",{staticStyle:{"min-width":"100px"}},[e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.abrirModalUsuario}},[e("q-item-section",[t._v("Perfil")])],1),e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.efetuarLogout}},[e("q-item-section",[t._v("Sair")])],1),e("q-separator")],1)],1),e("q-space"),e("q-btn",{staticClass:"btn-rounded",attrs:{color:"black",icon:"mdi-home"},on:{click:()=>t.$router.push({name:"home-dashboard"})}},[e("q-tooltip",{attrs:{"content-class":"bg-padrao text-grey-9 text-bold"}},[t._v("\n            Retornar ao menu\n          ")])],1)],1),t._e(),e("q-toolbar",{directives:[{name:"show",rawName:"v-show",value:t.toolbarSearch,expression:"toolbarSearch"}],staticClass:"row q-gutter-sm q-py-sm items-center"},[e("q-separator",{staticClass:"absolute-top"}),e("q-btn",{staticClass:"btn-rounded",attrs:{icon:t.cFiltroSelecionado?"mdi-filter-plus":"mdi-filter-outline",color:t.cFiltroSelecionado?"deep-orange-9":"primary"}},[e("q-menu",{attrs:{"content-class":"shadow-10 no-scroll",square:""}},[e("div",{staticClass:"row q-pa-sm",staticStyle:{"min-width":"350px","max-width":"350px"}},[e("div",{staticClass:"q-ma-sm"},[e("div",{staticClass:"text-h6 q-mb-md"},[t._v("Filtros Avançados")]),"admin"===t.profile?e("q-toggle",{staticClass:"q-ml-lg",class:{"q-mb-lg":t.pesquisaTickets.showAll},attrs:{label:"(Admin) - Visualizar Todos"},on:{input:function(e){t.debounce(t.BuscarTicketFiltro(),700)}},model:{value:t.pesquisaTickets.showAll,callback:function(e){t.$set(t.pesquisaTickets,"showAll",e)},expression:"pesquisaTickets.showAll"}}):t._e(),t.pesquisaTickets.showAll?t._e():e("q-separator",{staticClass:"q-mb-md"}),t.pesquisaTickets.showAll?t._e():e("div",[e("q-select",{attrs:{disable:t.pesquisaTickets.showAll,rounded:"",dense:"",outlined:"","hide-bottom-space":"","emit-value":"","map-options":"",multiple:"","options-dense":"","use-chips":"",label:"Filas",color:"primary",options:t.cUserQueues,"input-debounce":700,"option-value":"id","option-label":"queue","input-style":"width: 300px; max-width: 300px;"},on:{input:function(e){t.debounce(t.BuscarTicketFiltro(),700)}},model:{value:t.pesquisaTickets.queuesIds,callback:function(e){t.$set(t.pesquisaTickets,"queuesIds",e)},expression:"pesquisaTickets.queuesIds"}}),e("q-list",{staticClass:"q-my-md",attrs:{dense:""}},[e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[e("q-item-section",{attrs:{avatar:""}},[e("q-checkbox",{attrs:{val:"open",color:"primary","keep-color":""},on:{input:function(e){t.debounce(t.BuscarTicketFiltro(),700)}},model:{value:t.pesquisaTickets.status,callback:function(e){t.$set(t.pesquisaTickets,"status",e)},expression:"pesquisaTickets.status"}})],1),e("q-item-section",[e("q-item-label",[t._v("Abertos")])],1)],1),e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[e("q-item-section",{attrs:{avatar:""}},[e("q-checkbox",{attrs:{val:"pending",color:"negative","keep-color":""},on:{input:function(e){t.debounce(t.BuscarTicketFiltro(),700)}},model:{value:t.pesquisaTickets.status,callback:function(e){t.$set(t.pesquisaTickets,"status",e)},expression:"pesquisaTickets.status"}})],1),e("q-item-section",[e("q-item-label",[t._v("Pendentes")])],1)],1),e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[e("q-item-section",{attrs:{avatar:""}},[e("q-checkbox",{attrs:{val:"closed",color:"positive","keep-color":""},on:{input:function(e){t.debounce(t.BuscarTicketFiltro(),700)}},model:{value:t.pesquisaTickets.status,callback:function(e){t.$set(t.pesquisaTickets,"status",e)},expression:"pesquisaTickets.status"}})],1),e("q-item-section",[e("q-item-label",[t._v("Resolvidos")])],1)],1)],1),e("q-separator",{staticClass:"q-mb-md"}),e("q-toggle",{attrs:{label:"Somente Tickets com mensagens não lidas"},on:{input:function(e){t.debounce(t.BuscarTicketFiltro(),700)}},model:{value:t.pesquisaTickets.withUnreadMessages,callback:function(e){t.$set(t.pesquisaTickets,"withUnreadMessages",e)},expression:"pesquisaTickets.withUnreadMessages"}}),e("q-toggle",{attrs:{label:"Somente Tickets não atribuidos (sem usuário definido)"},on:{input:function(e){t.debounce(t.BuscarTicketFiltro(),700)}},model:{value:t.pesquisaTickets.isNotAssignedUser,callback:function(e){t.$set(t.pesquisaTickets,"isNotAssignedUser",e)},expression:"pesquisaTickets.isNotAssignedUser"}})],1),t.pesquisaTickets.showAll?t._e():e("q-separator",{staticClass:"q-my-md",attrs:{spaced:""}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"float-right q-my-md",attrs:{color:"negative",label:"Fechar",push:"",rounded:""}})],1)])]),e("q-tooltip",{attrs:{"content-class":"bg-padrao text-grey-9 text-bold"}},[t._v("\n            Filtro Avançado\n          ")])],1),e("q-input",{staticClass:"col-grow",attrs:{dense:"",outlined:"",rounded:"",type:"search",debounce:700},on:{input:function(e){return t.BuscarTicketFiltro()}},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.pesquisaTickets.searchParam,callback:function(e){t.$set(t.pesquisaTickets,"searchParam",e)},expression:"pesquisaTickets.searchParam"}}),e("q-btn",{staticClass:"btn-rounded",attrs:{color:"primary",icon:"mdi-book-account-outline"},on:{click:function(e){t.$q.screen.lt.md?t.modalNovoTicket=!0:t.$router.push({name:"chat-contatos"})}}},[e("q-tooltip",{attrs:{"content-class":"bg-padrao text-grey-9 text-bold"}},[t._v("\n            Contatos\n          ")])],1),e("q-separator",{staticClass:"absolute-bottom"})],1),e("q-scroll-area",{ref:"scrollAreaTickets",staticStyle:{height:"calc(100% - 180px)"},on:{scroll:t.onScroll}},[e("div",[e("div",{staticClass:"tab-container"},[e("q-tabs",{staticClass:"tab-scroll",model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[t.openTickets.length>0?e("q-tab",{attrs:{name:"open"}},[t._v("\n                Abertos\n                "),t.openTickets.length>0?e("q-badge",{attrs:{color:"red",textColor:"white"}},[t._v(t._s(t.openTickets.length))]):t._e()],1):t._e(),t.pendingTickets.length>0?e("q-tab",{attrs:{name:"pending"}},[t._v("\n                Pendentes\n                "),t.pendingTickets.length>0?e("q-badge",{attrs:{color:"red",textColor:"white"}},[t._v(t._s(t.pendingTickets.length))]):t._e()],1):t._e(),t.closedTickets.length>0?e("q-tab",{attrs:{name:"closed"}},[t._v("\n                Fechados\n                "),t.closedTickets.length>0?e("q-badge",{attrs:{color:"red",textColor:"white"}},[t._v(t._s(t.closedTickets.length))]):t._e()],1):t._e(),t.groupTickets.length>0?e("q-tab",{attrs:{name:"group"}},[t._v("\n                Grupos\n                "),t.groupTickets.length>0?e("q-badge",{attrs:{color:"red",textColor:"white"}},[t._v(t._s(t.groupTickets.length))]):t._e()],1):t._e()],1)],1),"open"===t.selectedTab?e("div",t._l(t.openTickets,(function(a,s){return e("ItemTicket",{key:s,attrs:{ticket:a,filas:t.filas}})})),1):t._e(),"pending"===t.selectedTab?e("div",t._l(t.pendingTickets,(function(a,s){return e("ItemTicket",{key:s,attrs:{ticket:a,filas:t.filas}})})),1):t._e(),"closed"===t.selectedTab?e("div",t._l(t.closedTickets,(function(a,s){return e("ItemTicket",{key:s,attrs:{ticket:a,filas:t.filas}})})),1):t._e(),"group"===t.selectedTab?e("div",t._l(t.groupTickets,(function(a,s){return e("ItemTicket",{key:s,attrs:{ticket:a,filas:t.filas}})})),1):t._e()]),t.loading?e("div",[e("div",{staticClass:"row justify-center q-my-md"},[e("q-spinner",{attrs:{color:"white",size:"3em",thickness:3}})],1),e("div",{staticClass:"row col justify-center q-my-sm text-white"},[t._v("\n            Carregando...\n          ")])]):t._e()]),e("div",{staticClass:"absolute-bottom row justify-between",staticStyle:{height:"50px"}},[e("q-toggle",{staticClass:"text-bold q-ml-md flex flex-block",attrs:{size:"xl","keep-color":"",dense:"","icon-color":t.$q.dark.isActive?"black":"white",value:t.$q.dark.isActive,color:t.$q.dark.isActive?"grey-3":"black","checked-icon":"mdi-white-balance-sunny","unchecked-icon":"mdi-weather-sunny"},on:{input:function(e){return t.$setConfigsUsuario({isDark:!t.$q.dark.isActive})}}},[e("q-tooltip",{attrs:{"content-class":"text-body1"}},[t._v("\n            "+t._s(t.$q.dark.isActive?"Desativar":"Ativar")+" Modo Escuro (Dark Mode)\n          ")])],1),e("div",{staticClass:"flex flex-inline q-pt-xs"},[e("q-scroll-area",{staticStyle:{heigth:"40px",width:"300px"},attrs:{horizontal:""}},[t._l(t.whatsapps,(function(t){return[e("q-btn",{key:t.id,staticClass:"q-mx-xs q-pa-none",style:"opacity: "+("CONNECTED"===t.status?1:.2),attrs:{rounded:"",flat:"",dense:"",size:"18px",icon:`img:${t.type}-logo.png`}},[e("q-tooltip",{attrs:{"max-height":"300px","content-class":"bg-blue-1 text-body1 text-grey-9 hide-scrollbar"}},[e("ItemStatusChannel",{attrs:{item:t}})],1)],1)]}))],2)],1)],1)],1),e("q-page-container",[e("router-view",{key:t.ticketFocado.id,attrs:{mensagensRapidas:t.mensagensRapidas}})],1),!t.cRouteContatos&&t.ticketFocado.id?e("q-drawer",{attrs:{"show-if-above":"",bordered:"",side:"right","content-class":"bg-grey-1"},model:{value:t.drawerContact,callback:function(e){t.drawerContact=e},expression:"drawerContact"}},[e("div",{staticClass:"bg-white full-width no-border-radius q-pa-sm",staticStyle:{height:"60px"}},[e("span",{staticClass:"q-ml-md text-h6"},[t._v("\n          Dados Contato\n        ")])]),e("q-separator"),"admin"==t.profile?e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[e("q-card",{staticClass:"bg-white btn-rounded q-mt-sm",staticStyle:{width:"100%"},attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"text-bold q-pa-sm"},[e("q-btn",{staticClass:"bg-padrao btn-rounded",attrs:{flat:"",color:t.$q.dark.isActive?"white":"grey-9",label:"Logs",icon:"mdi-timeline-text-outline"},on:{click:t.abrirModalLogs}})],1)],1)],1):t._e(),e("q-scroll-area",{staticStyle:{height:"calc(100vh - 70px)"}},[e("div",{staticClass:"q-pa-sm"},[e("q-card",{staticClass:"bg-white btn-rounded",staticStyle:{width:"100%"},attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"text-center"},[e("q-avatar",{staticStyle:{border:"1px solid #9e9e9ea1 !important",width:"100px",height:"100px"}},[t.ticketFocado.contact.profilePicUrl?t._e():e("q-icon",{staticStyle:{width:"100px",height:"100px"},attrs:{name:"mdi-account",size:"6em",color:"grey-5"}}),e("q-img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.ticketFocado.contact.profilePicUrl},scopedSlots:t._u([{key:"error",fn:function(){return[e("q-icon",{attrs:{name:"mdi-account",size:"1.5em",color:"grey-5"}})]},proxy:!0}],null,!1,3798146443)})],1),e("div",{staticClass:"text-caption q-mt-md",staticStyle:{"font-size":"14px"}},[t._v("\n                "+t._s(t.ticketFocado.contact.name||"")+"\n              ")]),e("div",{staticClass:"text-caption q-mt-sm",staticStyle:{"font-size":"14px"},attrs:{id:"number"},on:{click:function(e){return t.copyContent(t.ticketFocado.contact.number||"")}}},[t._v("\n                "+t._s(t.ticketFocado.contact.number||"")+"\n              ")]),e("div",{staticClass:"text-caption q-mt-md",staticStyle:{"font-size":"14px"},attrs:{id:"email"},on:{click:function(e){return t.copyContent(t.ticketFocado.contact.email||"")}}},[t._v("\n                "+t._s(t.ticketFocado.contact.email||"")+"\n              ")]),e("q-btn",{staticClass:"q-mt-sm bg-padrao btn-rounded",attrs:{color:"primary",flat:"",icon:"edit",label:"Editar Contato"},on:{click:function(e){return t.editContact(t.ticketFocado.contact.id)}}})],1)],1),e("q-card",{key:t.ticketFocado.id+t.$uuid(),staticClass:"bg-white q-mt-sm btn-rounded",staticStyle:{width:"100%"},attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"text-bold q-pb-none"},[t._v("\n              Etiquetas\n              "),e("q-separator")],1),e("q-card-section",{staticClass:"q-pa-none"},[e("q-select",{attrs:{square:"",borderless:"",value:t.ticketFocado.contact.tags,multiple:"",options:t.etiquetas,"use-chips":"","option-value":"id","option-label":"tag","emit-value":"","map-options":"","dropdown-icon":"add"},on:{input:t.tagSelecionada},scopedSlots:t._u([{key:"option",fn:function({itemProps:a,itemEvents:s,opt:o,selected:i,toggleOption:n}){return[e("q-item",t._g(t._b({},"q-item",a,!1),s),[e("q-item-section",[e("q-item-label",{domProps:{innerHTML:t._s(o.tag)}})],1),e("q-item-section",{attrs:{side:""}},[e("q-checkbox",{attrs:{value:i},on:{input:function(t){return n(o)}}})],1)],1)]}},{key:"selected-item",fn:function({opt:a}){return[e("q-chip",{staticClass:"q-ma-xs row col-12 text-body1",attrs:{dense:"",square:"",color:"white","text-color":"primary"}},[e("q-icon",{staticClass:"q-mr-sm",style:`color: ${a.color}`,attrs:{name:"mdi-pound-box-outline",size:"28px"}}),t._v("\n                    "+t._s(a.tag)+"\n                  ")],1)]}},{key:"no-option",fn:function({itemProps:a,itemEvents:s}){return[e("q-item",t._g(t._b({},"q-item",a,!1),s),[e("q-item-section",[e("q-item-label",{staticClass:"text-negative text-bold"},[t._v("\n                        Ops... Sem etiquetas criadas!\n                      ")]),e("q-item-label",{attrs:{caption:""}},[t._v("\n                        Cadastre novas etiquetas na administração de sistemas.\n                      ")])],1)],1)]}}],null,!1,3079271781)})],1)],1),e("q-card",{key:t.ticketFocado.id+t.$uuid(),staticClass:"bg-white q-mt-sm btn-rounded",staticStyle:{width:"100%"},attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"text-bold q-pb-none"},[t._v("\n              Carteira\n              "),e("q-separator")],1),e("q-card-section",{staticClass:"q-pa-none"},[e("q-select",{attrs:{square:"",borderless:"",value:t.ticketFocado.contact.wallets,multiple:"","max-values":1,options:t.usuarios,"use-chips":"","option-value":"id","option-label":"name","emit-value":"","map-options":"","dropdown-icon":"add"},on:{input:t.carteiraDefinida},scopedSlots:t._u([{key:"option",fn:function({itemProps:a,itemEvents:s,opt:o,selected:i,toggleOption:n}){return[e("q-item",t._g(t._b({},"q-item",a,!1),s),[e("q-item-section",[e("q-item-label",{domProps:{innerHTML:t._s(o.name)}})],1),e("q-item-section",{attrs:{side:""}},[e("q-checkbox",{attrs:{value:i},on:{input:function(t){return n(o)}}})],1)],1)]}},{key:"selected-item",fn:function({opt:a}){return[e("q-chip",{staticClass:"q-ma-xs row col-12 text-body1",attrs:{dense:"",square:"",color:"white","text-color":"primary"}},[t._v("\n                    "+t._s(a.name)+"\n                  ")])]}},{key:"no-option",fn:function({itemProps:a,itemEvents:s}){return[e("q-item",t._g(t._b({},"q-item",a,!1),s),[e("q-item-section",[e("q-item-label",{staticClass:"text-negative text-bold"},[t._v("\n                        Ops... Sem carteiras disponíveis!!\n                      ")])],1)],1)]}}],null,!1,382737987)})],1)],1),e("q-card",{key:t.ticketFocado.id+t.$uuid(),staticClass:"bg-white q-mt-sm btn-rounded",staticStyle:{width:"100%"},attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"text-bold q-pb-none"},[t._v("\n              Mensagens Agendadas\n              "),e("q-separator")],1),e("q-card-section",{staticClass:"q-pa-none"},[t.ticketFocado.scheduledMessages?[e("q-list",t._l(t.ticketFocado.scheduledMessages.filter((t=>!t.isDeleted)),(function(a,s){return e("q-item",{key:s,attrs:{clickable:""}},[e("q-item-section",[e("q-item-label",{attrs:{caption:""}},[e("b",[t._v("Agendado para:")]),t._v(" "+t._s(t.$formatarData(a.scheduleDate,"dd/MM/yyyy HH:mm"))+"\n                        "),e("q-btn",{staticClass:"absolute-top-right q-mr-sm",attrs:{flat:"",round:"",dense:"",icon:"mdi-trash-can-outline",size:"sm"},on:{click:function(e){return t.deletarMensagem(a)}}})],1),e("q-item-label",{attrs:{caption:"",lines:"2"}},[e("b",[t._v("Msg:")]),t._v(" "+t._s(a.mediaName||a.body)+"\n                      ")])],1),e("q-tooltip",{attrs:{delay:500}},[e("MensagemChat",{attrs:{mensagens:[a]}})],1)],1)})),1)]:t._e()],2)],1),e("q-card",{key:t.ticketFocado.id+t.$uuid(),staticClass:"bg-white q-mt-sm btn-rounded",staticStyle:{width:"100%"},attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"text-bold q-pb-none"},[t._v("\n              Outras Informações\n            ")]),e("q-card-section",{staticClass:"q-pa-none"},[t.cIsExtraInfo?[e("q-list",t._l(t.ticketFocado.contact.extraInfo,(function(a,s){return e("q-item",{key:s},[e("q-item-section",[e("q-item-label",[t._v(t._s(a.value))])],1)],1)})),1)]:t._e()],2)],1)],1)])],1):t._e(),e("ModalNovoTicket",{attrs:{modalNovoTicket:t.modalNovoTicket},on:{"update:modalNovoTicket":function(e){t.modalNovoTicket=e},"update:modal-novo-ticket":function(e){t.modalNovoTicket=e}}}),e("ContatoModal",{attrs:{contactId:t.selectedContactId,modalContato:t.modalContato},on:{"update:modalContato":function(e){t.modalContato=e},"update:modal-contato":function(e){t.modalContato=e},"contatoModal:contato-editado":t.contatoEditado}}),e("ModalUsuario",{attrs:{isProfile:!0,modalUsuario:t.modalUsuario,usuarioEdicao:t.usuario},on:{"update:modalUsuario":function(e){t.modalUsuario=e},"update:modal-usuario":function(e){t.modalUsuario=e},"update:usuarioEdicao":function(e){t.usuario=e},"update:usuario-edicao":function(e){t.usuario=e}}}),e("q-dialog",{attrs:{"no-backdrop-dismiss":"","full-height":"",position:"right"},on:{hide:function(e){t.logsTicket=[]}},model:{value:t.exibirModalLogs,callback:function(e){t.exibirModalLogs=e},expression:"exibirModalLogs"}},[e("q-card",{staticStyle:{width:"400px"}},[e("q-card-section",{class:{"bg-grey-2":!t.$q.dark.isActive,"bg-primary":t.$q.dark.isActive}},[e("div",{staticClass:"text-h6"},[t._v("Logs Ticket: "+t._s(t.ticketFocado.id)+"\n            "),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-padrao float-right",attrs:{icon:"close",color:"negative",flat:"",round:""}})],1)]),e("q-card-section",{},[e("q-scroll-area",{staticClass:"full-width",staticStyle:{height:"calc(100vh - 200px)"}},[e("q-timeline",{staticClass:"q-pl-sm",class:{"text-black":!t.$q.dark.isActive},staticStyle:{width:"360px"},attrs:{color:"black"}},[t._l(t.logsTicket,(function(a,s){return[e("q-timeline-entry",{key:a&&a.id||s,attrs:{subtitle:t.$formatarData(a.createdAt,"dd/MM/yyyy HH:mm"),color:t.messagesLog[a.type]&&t.messagesLog[a.type].color||"",icon:t.messagesLog[a.type]&&t.messagesLog[a.type].icon||""},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",{class:{"text-white":t.$q.dark.isActive},staticStyle:{width:"calc(100% - 20px)"}},[e("div",{staticClass:"row col text-bold text-body2"},[t._v(" "+t._s(a.user&&a.user.name||"Bot")+":")]),e("div",{staticClass:"row col"},[t._v(" "+t._s(t.messagesLog[a.type]&&t.messagesLog[a.type].message))])])]},proxy:!0}],null,!0)})]}))],2)],1)],1)],1)],1)],1),e("audio",{ref:"audioNotificationPlay"},[e("source",{attrs:{src:t.alertSound,type:"audio/mp3"}})])],1)},o=[],i=a("8039"),n=a("006a"),c=a("0ffe"),r=a("c5bd"),l=a("2f62"),d=a("0b67"),u=a("5d20"),p=function(){var t=this,e=t._self._c;return e("q-dialog",{attrs:{value:t.modalNovoTicket,persistent:""},on:{hide:t.fecharModal}},[e("q-card",{staticClass:"q-pa-md",staticStyle:{width:"500px"}},[e("q-card-section",[e("div",{staticClass:"text-h6"},[t._v("Criar Ticket")])]),e("q-card-section",[e("q-select",{ref:"selectAutoCompleteContato",attrs:{autofocus:"",square:"",outlined:"",filled:"","hide-dropdown-icon":"",loading:t.loading,options:t.contatos,"input-debounce":"700","use-input":"","hide-selected":"","fill-input":"","option-label":"name","option-value":"id",label:"Localizar Contato",hint:"Digite no mínimo duas letras para localizar o contato."},on:{filter:t.localizarContato},scopedSlots:t._u([{key:"before-options",fn:function(){return[e("q-btn",{staticClass:"full-width no-border-radius",attrs:{color:"primary","no-caps":"",padding:"",ripple:"",outline:"",icon:"add",label:"Adicionar Contato"},on:{click:function(e){t.modalContato=!0}}})]},proxy:!0},{key:"option",fn:function(a){return[a.opt.name?e("q-item",t._g(t._b({},"q-item",a.itemProps,!1),a.itemEvents),[e("q-item-section",[e("q-item-label",[t._v(" "+t._s(a.opt.name))]),e("q-item-label",{attrs:{caption:""}},[t._v(t._s(a.opt.number))])],1)],1):t._e()]}}]),model:{value:t.contatoSelecionado,callback:function(e){t.contatoSelecionado=e},expression:"contatoSelecionado"}})],1),e("q-card-actions",{staticClass:"q-pr-md",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-px-md q-mr-lg",attrs:{label:"Sair",color:"negative"}}),e("q-btn",{staticClass:"q-px-md",attrs:{label:"Salvar",color:"primary"},on:{click:t.criarTicket}})],1)],1),e("ContatoModal",{attrs:{modalContato:t.modalContato},on:{"update:modalContato":function(e){t.modalContato=e},"update:modal-contato":function(e){t.modalContato=e},"contatoModal:contato-criado":t.contatoCriadoNotoTicket}})],1)},m=[],h=a("73ad");const b=+localStorage.getItem("userId");var g={name:"ModalNovoTicket",components:{ContatoModal:n["a"]},props:{modalNovoTicket:{type:Boolean,default:!1}},data(){return{ticket:{},contatoSelecionado:null,contatos:[],modalContato:!1,loading:!1}},methods:{fecharModal(){this.ticket={},this.contatoSelecionado=null,this.$emit("update:modalNovoTicket",!1)},async localizarContato(t,e,a){if(t.length<2)return this.contatos.length&&e((()=>{this.contatos=[...this.contatos]})),void a();this.loading=!0;const{data:s}=await Object(h["h"])({searchParam:t});e((()=>{s.contacts.length?this.contatos=s.contacts:this.contatos=[{}]})),this.loading=!1},contatoCriadoNotoTicket(t){this.contatoSelecionado=t,this.criarTicket()},async criarTicket(){if(this.contatoSelecionado.id){this.loading=!0;try{const{data:t}=await Object(r["f"])({contactId:this.contatoSelecionado.id,isActiveDemand:!0,userId:b,status:"open"});await this.$store.commit("SET_HAS_MORE",!0),await this.$store.dispatch("AbrirChatMensagens",t),this.$q.notify({message:`Atendimento Iniciado || ${t.contact.name} - Ticket: ${t.id}`,type:"positive",progress:!0,position:"top",actions:[{icon:"close",round:!0,color:"white"}]}),this.fecharModal(),"atendimento"!==this.$route.name&&this.$router.push({name:"atendimento"})}catch(t){console.error(t),this.$notificarErro("Ocorreu um erro ao iniciar o atendimento!",t)}this.loading=!1}}},destroyed(){this.contatoSelecionado=null}},q=g,f=a("2877"),k=a("24e8"),v=a("f09f"),C=a("a370"),w=a("ddd8"),y=a("9c40"),T=a("66e5"),x=a("4074"),_=a("0170"),S=a("4b7e"),I=a("7f67"),$=a("eebe"),N=a.n($),M=Object(f["a"])(q,p,m,!1,null,"51d58e83",null),A=M.exports;N()(M,"components",{QDialog:k["a"],QCard:v["a"],QCardSection:C["a"],QSelect:w["a"],QBtn:y["a"],QItem:T["a"],QItemSection:x["a"],QItemLabel:_["a"],QCardActions:S["a"]}),N()(M,"directives",{ClosePopup:I["a"]});var Q=a("ee0e"),E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-inline q-gutter-sm"},[t._l(t.whatsapps,(function(a){return e("div",{key:a.id},[t.isIconStatusMenu?e("q-btn",{key:a.id,attrs:{unelevated:"",round:"",flat:"",color:t.isInvalidConnect(a)?"negative":"green"}},[t.isInvalidConnect(a)?t._e():e("q-icon",{attrs:{name:"mdi-wifi-check",size:"2em"}}),t.isInvalidConnect(a)?e("div",{staticClass:"notification-box"},[e("div",{staticClass:"notification-bell"},[e("span",{staticClass:"bell-top"}),e("span",{staticClass:"bell-middle"}),e("span",{staticClass:"bell-bottom"}),e("span",{staticClass:"bell-rad"})])]):t._e(),e("q-menu",{attrs:{anchor:"top right",self:"top left"}},[e("ItemStatusWhatsapp",{key:a.id,attrs:{wbot:a}})],1)],1):t._e()],1)})),e("transition",{attrs:{"transition-show":"flip-up","transition-hide":"flip-down"}},[!t.isIconStatusMenu&&t.whatsapps.length&&t.isProblemConnect?e("q-carousel",{ref:"carouselStatusWhatsapp",staticClass:"q-pa-none q-ma-none full-width bg-amber",attrs:{"transition-prev":"slide-right","transition-next":"slide-left",animated:"",swipeable:"",height:"90px"},scopedSlots:t._u([{key:"control",fn:function(){return[t.isBtnSlider?e("q-carousel-control",{staticClass:"q-gutter-xs",attrs:{position:"bottom-right",offset:[10,40]}},[e("q-btn",{attrs:{round:"",flat:"",dense:"",color:"white","text-color":"black",icon:"arrow_left"},on:{click:function(e){return t.$refs.carouselStatusWhatsapp.previous()}}}),e("q-btn",{attrs:{round:"",flat:"",dense:"",color:"white","text-color":"black",icon:"arrow_right"},on:{click:function(e){return t.$refs.carouselStatusWhatsapp.next()}}})],1):t._e()]},proxy:!0}],null,!1,2197069275),model:{value:t.idWbotVisible,callback:function(e){t.idWbotVisible=e},expression:"idWbotVisible"}},[t._l(t.whatsapps,(function(t,a){return[e("q-carousel-slide",{key:t.id+a,staticClass:"q-pa-none q-ma-none",attrs:{name:a}},[e("ItemStatusWhatsapp",{attrs:{wbot:t}})],1)]}))],2):t._e()],1)],2)},O=[],F=function(){var t=this,e=t._self._c;return e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.wbot.id,staticClass:"full-width full-height",attrs:{clickable:"",dense:""}},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{color:t.status[t.wbot.status].color,size:"2.5em",name:t.status[t.wbot.status].icon}})],1),e("q-item-section",[e("q-item-label",{attrs:{lines:"1"}},[t._v("\n      Nome: "+t._s(t.wbot.name)+"\n    ")]),e("q-item-label",{attrs:{caption:"",lines:"1"}},[t._v("\n      "+t._s(t.status[t.wbot.status].status)+"\n    ")]),t.isIconStatusMenu?e("q-item-label",{attrs:{caption:"",lines:"3"}},[t._v("\n      "+t._s(t.status[t.wbot.status].description)+"\n    ")]):t._e()],1),t.isIconStatusMenu?t._e():e("q-tooltip",{attrs:{"content-class":"bg-light-blue-1 text-black q-pa-sm shadow-4"}},[e("span",{staticClass:"text-weight-medium"},[t._v(" "+t._s(t.status[t.wbot.status].description)+" ")])])],1)},D=[],L={name:"ItemStatusWhatsapp",props:{wbot:{type:Object,default:()=>{}},isIconStatusMenu:{type:Boolean,default:!0}},data(){return{status:{PAIRING:{color:"info",icon:"mdi-cellphone-wireles",status:"Emparelhando",description:"Emparelhando sessão Whatsapp."},TIMEOUT:{color:"warning",icon:"mdi-timer-outline",status:"Timeout",description:"As tentativas de conexão falharam. Verifique a internet no celular."},DISCONNECTED:{color:"negative",icon:"mdi-wifi-strength-1-alert",status:"Desconectado",description:"Verifique se o celular do Whatsapp possui conexão com internet."},qrcode:{color:"positive",icon:"mdi-qrcode-scan",status:"Qr Code",description:"Necessário Ler o Qr Code"},DESTROYED:{color:"primary",icon:"mdi-close-network-outline",status:"Inativo",description:"Necessário iniciar a conexão com o Whatsapp e Ler o Qr Code."},CONFLICT:{color:"warning",icon:"mdi-equal",status:"Conflito",description:"Whatsapp Web sendo utilizado."},OPENING:{color:"black",icon:"mdi-connection",status:"Conectando",description:"Iniciando conexão com o Whatsapp."},CONNECTED:{color:"green-8",icon:"mdi-wifi-arrow-up-down",status:"Conectado",description:"Conexão estabelecida com sucesso!"}}}}},P=L,U=(a("0513"),a("0016")),j=a("05c0"),W=a("714f"),B=Object(f["a"])(P,F,D,!1,null,null,null),z=B.exports;N()(B,"components",{QItem:T["a"],QItemSection:x["a"],QIcon:U["a"],QItemLabel:_["a"],QTooltip:j["a"]}),N()(B,"directives",{Ripple:W["a"]});var R={name:"StatusWhatsapp",components:{ItemStatusWhatsapp:z},props:{isIconStatusMenu:{type:Boolean,default:!1}},data(){return{idWbotVisible:0,isProblemConnect:!1}},watch:{whatsapps:{handler(){const t=-1!==this.whatsapps.findIndex((t=>"CONNECTED"!==t.status));setTimeout((()=>{this.isProblemConnect=t}),3e3)},deep:!0,immediate:!0}},computed:{...Object(l["b"])(["whatsapps"]),isBtnSlider(){const t=this.whatsapps.filter((t=>"CONNECTED"!==t.status));return t>1}},methods:{isInvalidConnect(t){const e=["PAIRING","TIMEOUT","DISCONNECTED","qrcode","DESTROYED","CONFLICT"],a=e.findIndex((e=>e===t.status));return-1!==a}},mounted(){this.isProblemConnect=-1!==this.whatsapps.findIndex((t=>"CONNECTED"!==t.status))}},H=R,V=a("4e73"),J=a("880c"),G=a("62cd"),K=a("32a7"),Y=a("2c91"),X=a("cb32"),Z=a("1c1c"),tt=a("eb85"),et=Object(f["a"])(H,E,O,!1,null,null,null),at=et.exports;N()(et,"components",{QBtn:y["a"],QIcon:U["a"],QMenu:V["a"],QCarousel:J["a"],QCarouselSlide:G["a"],QCarouselControl:K["a"],QTooltip:j["a"],QSpace:Y["a"],QAvatar:X["a"],QList:Z["a"],QItemLabel:_["a"],QSeparator:tt["a"],QItem:T["a"],QItemSection:x["a"]}),N()(et,"directives",{ClosePopup:I["a"]});var st=a("86e2"),ot=a.n(st),it=a("5c26"),nt=a("1c16"),ct=a("b166"),rt=a("25c4"),lt=a("7963"),dt=a("1394"),ut=a("163e"),pt=a("7884"),mt=a("9a1b"),ht=a("ef42"),bt=a("c9d9");const gt=JSON.parse(localStorage.getItem("queues")),qt=localStorage.getItem("profile"),ft=localStorage.getItem("username"),kt=JSON.parse(localStorage.getItem("usuario"));var vt={name:"IndexAtendimento",mixins:[d["a"],u["a"]],components:{ItemTicket:c["a"],ModalNovoTicket:A,StatusWhatsapp:at,ContatoModal:n["a"],ModalUsuario:rt["a"],MensagemChat:ht["a"],ItemStatusChannel:i["a"]},data(){return{messagesLog:bt["c"],configuracoes:[],debounce:nt["a"],alertSound:ot.a,usuario:kt,usuarios:[],selectedTab:"open",username:ft,modalUsuario:!1,toolbarSearch:!0,drawerTickets:!0,drawerContact:!0,loading:!1,profile:qt,modalNovoTicket:!1,modalContato:!1,selectedContactId:null,filterBusca:"",showDialog:!1,atendimentos:[],countTickets:0,pesquisaTickets:{searchParam:"",pageNumber:1,status:["open","pending","closed"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!1,isNotAssignedUser:!1,includeNotQueueDefined:!0},filas:[],etiquetas:[],mensagensRapidas:[],modalEtiquestas:!1,exibirModalLogs:!1,logsTicket:[]}},watch:{},computed:{...Object(l["b"])(["tickets","ticketFocado","hasMore","whatsapps"]),cUserQueues(){return gt},style(){return{height:this.$q.screen.height+"px"}},cToolbarSearchHeigthAjust(){return this.toolbarSearch?58:0},cHeigVerticalTabs(){return`${50+this.cToolbarSearchHeigthAjust}px`},cRouteContatos(){return"chat-contatos"===this.$route.name},cFiltroSelecionado(){const{queuesIds:t,showAll:e,withUnreadMessages:a,isNotAssignedUser:s}=this.pesquisaTickets;return!!(null!==t&&void 0!==t&&t.length||e||a||s)},cIsExtraInfo(){var t,e,a;return(null===(t=this.ticketFocado)||void 0===t||null===(e=t.contact)||void 0===e||null===(a=e.extraInfo)||void 0===a?void 0:a.length)>0},openTickets(){return console.log(this.tickets),this.tickets.filter((t=>"open"===t.status&&!t.isGroup))},pendingTickets(){return this.tickets.filter((t=>"pending"===t.status&&!t.isGroup))},closedTickets(){return this.tickets.filter((t=>"closed"===t.status&&!t.isGroup))},groupTickets(){return this.tickets.filter((t=>t.isGroup))}},methods:{handlerNotifications(t){const e={body:`${t.body} - ${Object(ct["a"])(new Date,"HH:mm")}`,icon:t.ticket.contact.profilePicUrl,tag:t.ticket.id,renotify:!0},a=new Notification(`Mensagem de ${t.ticket.contact.name}`,e);setTimeout((()=>{a.close()}),1e4),a.onclick=e=>{e.preventDefault(),window.focus(),this.$store.dispatch("AbrirChatMensagens",t.ticket),this.$router.push({name:"atendimento"})},this.$nextTick((()=>{this.$refs.audioNotificationPlay.play()}))},async listarConfiguracoes(){const{data:t}=await Object(lt["b"])();localStorage.setItem("configuracoes",JSON.stringify(t))},onScroll(t){t.verticalPercentage<=.85||this.onLoadMore()},editContact(t){this.selectedContactId=t,this.modalContato=!0},contatoEditado(t){this.$store.commit("UPDATE_TICKET_FOCADO_CONTACT",t)},async consultarTickets(t={}){const e={...this.pesquisaTickets,...t};try{const{data:t}=await Object(r["e"])(e);this.countTickets=t.count,this.$store.commit("LOAD_TICKETS",t.tickets),this.$store.commit("SET_HAS_MORE",t.hasMore)}catch(a){this.$notificarErro("Algum problema",a),console.error(a)}},async BuscarTicketFiltro(){this.$store.commit("RESET_TICKETS"),this.loading=!0,localStorage.setItem("filtrosAtendimento",JSON.stringify(this.pesquisaTickets)),this.pesquisaTickets={...this.pesquisaTickets,pageNumber:1},await this.consultarTickets(this.pesquisaTickets),this.loading=!1,this.$setConfigsUsuario({isDark:this.$q.dark.isActive})},async onLoadMore(){if(0!==this.tickets.length&&this.hasMore&&!this.loading)try{this.loading=!0,this.pesquisaTickets.pageNumber++,await this.consultarTickets(),this.loading=!1}catch(t){this.loading=!1}},async listarFilas(){const{data:t}=await Object(Q["d"])();this.filas=t,localStorage.setItem("filasCadastradas",JSON.stringify(t||[]))},async listarWhatsapps(){const{data:t}=await Object(it["d"])();this.$store.commit("LOAD_WHATSAPPS",t)},async listarEtiquetas(){const{data:t}=await Object(ut["d"])(!0);this.etiquetas=t},async abrirModalUsuario(){this.modalUsuario=!0},async efetuarLogout(){console.log("logout - index atendimento");try{await Object(pt["b"])(kt),localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("profile"),localStorage.removeItem("userId"),localStorage.removeItem("queues"),localStorage.removeItem("usuario"),localStorage.removeItem("filtrosAtendimento"),this.$router.go({name:"login",replace:!0})}catch(t){this.$notificarErro("Não foi possível realizar logout",t)}},copyContent(t){navigator.clipboard.writeText(t).then((()=>{console.log("Conteúdo copiado: ",t)})).catch((t=>{console.error("Erro ao copiar o conteúdo: ",t)}))},deletarMensagem(t){const e={...t};this.$q.dialog({title:"Atenção!! Deseja realmente deletar a mensagem? ",message:"Mensagens antigas não serão apagadas no cliente.",cancel:{label:"Não",color:"primary",push:!0},ok:{label:"Sim",color:"negative",push:!0},persistent:!0}).onOk((()=>{this.loading=!0,Object(r["g"])(e).then((e=>{this.loading=!1,t.isDeleted=!0})).catch((t=>{this.loading=!1,console.error(t),this.$notificarErro("Não foi possível apagar a mensagem",t)}))})).onCancel((()=>{}))},async tagSelecionada(t){const{data:e}=await Object(h["e"])(this.ticketFocado.contact.id,[...t]);this.contatoEditado(e)},async carteiraDefinida(t){const{data:e}=await Object(h["c"])(this.ticketFocado.contact.id,[...t]);this.contatoEditado(e)},async listarUsuarios(){try{const{data:t}=await Object(mt["f"])();this.usuarios=t.users}catch(t){console.error(t),this.$notificarErro("Problema ao carregar usuários",t)}},setValueMenu(){this.drawerTickets=!this.drawerTickets},setValueMenuContact(){this.drawerContact=!this.drawerContact},async abrirModalLogs(){const{data:t}=await Object(r["d"])({ticketId:this.ticketFocado.id});this.logsTicket=t,this.exibirModalLogs=!0}},beforeMount(){this.listarFilas(),this.listarEtiquetas(),this.listarConfiguracoes();const t=JSON.parse(localStorage.getItem("filtrosAtendimento"));null!==t&&void 0!==t&&t.pageNumber||localStorage.setItem("filtrosAtendimento",JSON.stringify(this.pesquisaTickets))},async mounted(){var t,e;this.$root.$on("infor-cabecalo-chat:acao-menu",this.setValueMenu),this.$root.$on("update-ticket:info-contato",this.setValueMenuContact),this.socketTicketList(),this.pesquisaTickets=JSON.parse(localStorage.getItem("filtrosAtendimento")),this.$root.$on("handlerNotifications",this.handlerNotifications),await this.listarWhatsapps(),await this.consultarTickets(),await this.listarUsuarios();const{data:a}=await Object(dt["d"])();if(this.mensagensRapidas=a,"Notification"in window&&Notification.requestPermission(),this.userProfile=localStorage.getItem("profile"),null!==(t=this.$route)&&void 0!==t&&null!==(e=t.params)&&void 0!==e&&e.ticketId){var s,o;const t=null===(s=this.$route)||void 0===s||null===(o=s.params)||void 0===o?void 0:o.ticketId;if(t&&this.tickets.length>0){const e=this.tickets.find((e=>e.id===+t));if(!e)return;this.$q.screen.lt.md&&"pending"!==e.status&&this.$root.$emit("infor-cabecalo-chat:acao-menu"),console.log("before - AbrirChatMensagens",e),this.$store.commit("SET_HAS_MORE",!0),this.$store.dispatch("AbrirChatMensagens",e)}}else console.log("chat-empty"),this.$router.push({name:"chat-empty"})},destroyed(){this.$root.$off("handlerNotifications",this.handlerNotifications),this.$root.$off("infor-cabecalo-chat:acao-menu",this.setValueMenu),this.$root.$on("update-ticket:info-contato",this.setValueMenuContact),this.$store.commit("TICKET_FOCADO",{})}},Ct=vt,wt=(a("1b44"),a("4d5a")),yt=a("9404"),Tt=a("65c6"),xt=a("f20b"),_t=a("9564"),St=a("8f8e"),It=a("27f9"),$t=a("4983"),Nt=a("429b"),Mt=a("7460"),At=a("58a8"),Qt=a("0d59"),Et=a("09e3"),Ot=a("068f"),Ft=a("b047"),Dt=a("05eb"),Lt=a("74af"),Pt=a("8572"),Ut=Object(f["a"])(Ct,s,o,!1,null,null,null);e["default"]=Ut.exports;N()(Ut,"components",{QLayout:wt["a"],QDrawer:yt["a"],QToolbar:Tt["a"],QBtnDropdown:xt["a"],QList:Z["a"],QItem:T["a"],QItemSection:x["a"],QToggle:_t["a"],QSeparator:tt["a"],QSpace:Y["a"],QBtn:y["a"],QTooltip:j["a"],QMenu:V["a"],QSelect:w["a"],QCheckbox:St["a"],QItemLabel:_["a"],QInput:It["a"],QIcon:U["a"],QScrollArea:$t["a"],QTabs:Nt["a"],QTab:Mt["a"],QBadge:At["a"],QSpinner:Qt["a"],QPageContainer:Et["a"],QCard:v["a"],QCardSection:C["a"],QAvatar:X["a"],QImg:Ot["a"],QChip:Ft["a"],QDialog:k["a"],QTimeline:Dt["a"],QTimelineEntry:Lt["a"],QField:Pt["a"]}),N()(Ut,"directives",{ClosePopup:I["a"],Ripple:W["a"]})}}]);